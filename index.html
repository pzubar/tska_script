<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>TSKA-SCRIPT</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
	<style type="text/css" media="print">
		.no-print { display: none; }
		.main-container {
			height: auto!important;
		}
		.print { display: block; }
		.pagebreak { page-break-before: always; }
		.slide {
			margin: 0px!important;
			border: 0px solid white!important;
		}
		.cover-title {
			color: #6dc8eb !important;
		}
		.gt_by_pol_chart_container, .chart_container {
			border: 0px solid white!important;
		}
		p {
			padding-top: 0px;
		}
		.slide {
			overflow: hidden;
		}
		body, article {
			width: 100%;
			margin: 0;
			padding: 0;
		}

		textarea { border: none!important; resize: none!important; }
	</style>

</head>
<body>
	<link rel="stylesheet" href="style.css">

	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/annotations.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.10.8/xlsx.full.min.js"></script>

	<script src="pz_script.js"></script>
	<script src="chart_politics_by_gts.js"></script>	

	<script src="upd_vis.js"></script>						<!-- 2) -->
	<script src="reader_to_chart.js"></script> 		<!-- 1) -->	
	<script src="reader_xl_to_json.js"></script> 	<!-- 0) Has filereader onload callback that calls funcs above -->
	<script src="to_slides_vector.js"></script>


	<div id="navbar" class="no-print">
		<input type="file" onchange="ExcelToJSON(event)" />
		<!--<a href="#news" onclick="make_slides();">Сформувати презентацію</a>-->
		<a href="#contact" onclick="window.print();">Завантажити презентацію</a>
	</div>

	<div  class="no-print">
	<div id="buff"></div>
	<p>

	</p>

	</div>

	<div id="slides" class="print" contenteditable="true">
		<div class="slide pagebreak cover" >
			<div class="cover-img">
				<img  src="img/mainimage.png" alt="">
			</div>
			<div class="cover-info">
				<div class="textpart">
					<div class="cover-subtitle">Тут буде дата</div>
					<div class="cover-title">ПОРЯДОК ДЕННИЙ КЛЮЧОВИХ ПОЛІТИЧНИХ СПІКЕРІВ</div>
				</div>
			</div>
			<div class="top-part">
				<div class="top-triangles">
					<img src="img/top-triangles.png" alt="">
				</div>
				<div class="top-logo">
					<img src="img/top-logo.png" alt="">
					<img src="img/top-mediaportret.png" alt="">
				</div>

			</div>
		</div>
		<div style="display: none">
			<div class="slide pagebreak">
				<div class="slide-title"></div>
				<div class="slide-subtitle"></div>
				<div class="top-part">
					<div class="top-triangles">
						<img src="img/top-triangles.png" alt="">
					</div>
					<div class="top-logo">
						<img src="img/top-logo.png" alt="">
						<img src="img/top-mediaportret.png" alt="">
					</div>

				</div>
				<!--<textarea name="comment" cols="40" rows="3"></textarea>-->
			</div>
		</div>
	</div>

	<p class="no-print">Sheets:</p>
	<ul class="no-print" id="gt_ul"></ul>

	<div id="bigtopics-container" style="min-width: 310px; width: 1200px;margin: 0 auto"></div>

	<div class="gt_by_pol_chart_div_asses">
		<h3 style="text-align: center; font-family: 'Roboto Condensed'">Тематика заяв ключових політиків</h3>
		<div id="gt_by_pol_chart_container_asses" style="width: 1200px; height: 400px; margin: 0 auto; border: 1px dashed lightgray"></div>
		<p  class="no-print" id="politicians_count">Всього політиків: </p>
		<p  class="no-print">Split by:
			<input id="pol_by_gts_split_by_input" type="text" />
			<button id="pol_by_gts_split">Split</button>
		</p>
		<button class="toggle_title">Toggle title</button>
	</div>
	<div class="gt_by_pol_chart_div">
		<div style="text-align: center;">
			<div class="gt_by_pol_chart_container" style="max-width: 1200px; max-height: 600px; margin: 0 auto; border: 1px dashed lightgray"></div>
		</div>
		<!--<p class="no-print">Fix and export:-->
			<!--<button class="export_stacked_bar_btn">Export chart</button>-->
		<!--</p>-->
		<p class="no-print">Set width %:
			<input class="set_stacked_bar_width_input" type="text" style="width: 3em" value="50" />
			<button class="set_stacked_bar_width_btn">Set</button>
			<span>&emsp;</span>
			<button class="set_stacked_bar_width_orig_btn">Original</button>
		</p>
	</div>

	<div class="chart_div">
		<h3 class="gt_h3 no-print" style="text-align: center;">Gross topic 1</h3>
		<div class="chart_container" style="min-width: 310px; width: 1200px; height: 400px; margin: 0 auto; border: 1px dashed lightgray"></div>
		<!--<p class="no-print">Fix and export:-->
			<!--<button class="export_btn">Export chart</button>-->
		<!--</p>-->
			<b class="no-print">Змінити змістити підпис №:</b>
		</span>
		<input class="no-print bar_n" type="text" style="width: 3em" />
		<span class="no-print">
			<b class="no-print">X:</b>
		</span>
		<input class="no-print x_fix" type="number" style="width: 3em" />
		<span class="no-print">
			<b>Y:</b>
		</span>
		<input class="no-print y_fix" type="number" style="width: 3em" />
		<button class="no-print move_annotations_btn">Move</button>
		<span class="no-print">Масштабувати до:</span>
		<select class="no-print select_scalebygt"></select>
		<button class="no-print apply_scalebygt">Scale</button>
		<button class="no-print toggle_title">Toggle title</button>
		<span class="no-print">&emsp;</span>
		<button class="no-print scroll_to_top">^</button>
		<span class="no-print">Додати до:</span>
		<select class="no-print add-to-chart"></select>
		<button class="no-print apply-add-to-chart">Add</button>
		<!--<button class="no-print remove-slide">ВИДАЛИТИ СЛАЙД</button>-->
	</div>

<script>
    // When the user scrolls the page, execute myFunction
    window.onscroll = function() {myFunction()};

    // Get the navbar
    var navbar = document.getElementById("navbar");

    // Get the offset position of the navbar
    var sticky = navbar.offsetTop;

    // Add the sticky class to the navbar when you reach its scroll position. Remove "sticky" when you leave the scroll position
    function myFunction() {
        if (window.pageYOffset >= sticky) {
            navbar.classList.add("sticky")
        } else {
            navbar.classList.remove("sticky");
        }
    }



    document.onmousedown = function(e) {

        var dragElement = e.target;

        if (!dragElement.classList.contains('draggable')) return;

        var coords, shiftX, shiftY;

        startDrag(e.clientX, e.clientY);

        document.onmousemove = function(e) {
            moveAt(e.clientX, e.clientY);
        };

        dragElement.onmouseup = function() {
            finishDrag();
        };


        // -------------------------

        function startDrag(clientX, clientY) {

            shiftX = clientX - dragElement.getBoundingClientRect().left;
            shiftY = clientY - dragElement.getBoundingClientRect().top;

            dragElement.style.position = 'fixed';

            document.body.appendChild(dragElement);

            moveAt(clientX, clientY);
        };

        function finishDrag() {
            // конец переноса, перейти от fixed к absolute-координатам
            dragElement.style.top = parseInt(dragElement.style.top) + pageYOffset + 'px';
            dragElement.style.position = 'absolute';

            document.onmousemove = null;
            dragElement.onmouseup = null;
        }

        function moveAt(clientX, clientY) {
            // новые координаты
            var newX = clientX - shiftX;
            var newY = clientY - shiftY;

            // ------- обработаем вынос за нижнюю границу окна ------
            // новая нижняя граница элемента
            var newBottom = newY + dragElement.offsetHeight;

            // если новая нижняя граница вылезает вовне окна - проскроллим его
            if (newBottom > document.documentElement.clientHeight) {
                // координата нижней границы документа относительно окна
                var docBottom = document.documentElement.getBoundingClientRect().bottom;

                // scrollBy, если его не ограничить - может заскроллить за текущую границу документа
                // обычно скроллим на 10px
                // но если расстояние от newBottom до docBottom меньше, то меньше
                var scrollY = Math.min(docBottom - newBottom, 10);

                // ошибки округления при полностью прокрученной странице
                // могут привести к отрицательному scrollY, что будет означать прокрутку вверх
                // поправим эту ошибку
                if (scrollY < 0) scrollY = 0;

                window.scrollBy(0, scrollY);

                // резким движением мыши элемент можно сдвинуть сильно вниз
                // если он вышел за нижнюю границу документа -
                // передвигаем на максимально возможную нижнюю позицию внутри документа
                newY = Math.min(newY, document.documentElement.clientHeight - dragElement.offsetHeight);
            }


            // ------- обработаем вынос за верхнюю границу окна ------
            if (newY < 0) {
                // проскроллим вверх на 10px, либо меньше, если мы и так в самом верху
                var scrollY = Math.min(-newY, 10);
                if (scrollY < 0) scrollY = 0; // поправим ошибку округления

                window.scrollBy(0, -scrollY);
                // при резком движении мыши элемент мог "вылететь" сильно вверх, поправим его
                newY = Math.max(newY, 0);
            }


            // зажать в границах экрана по горизонтали
            // здесь прокрутки нет, всё просто
            if (newX < 0) newX = 0;
            if (newX > document.documentElement.clientWidth - dragElement.offsetHeight) {
                newX = document.documentElement.clientWidth - dragElement.offsetHeight;
            }

            dragElement.style.left = newX + 'px';
            dragElement.style.top = newY + 'px';
        }

        // отменим действие по умолчанию на mousedown (выделение текста, оно лишнее)
        // return false;
    }

    $('textarea').each(function () {
        this.setAttribute('style', 'height:' + (this.scrollHeight) + 'px;overflow-y:hidden;');
    }).on('input', function () {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    });

</script>
</body>
</html>
